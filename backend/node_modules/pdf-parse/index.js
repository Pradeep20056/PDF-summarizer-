const Fs = require('fs');
const Pdf = require('./lib/pdf-parse.js');

module.exports = Pdf;

// Dynamic PDF parsing function
// Accepts a file path or buffer
async function parsePDF(file) {
    try {
        let dataBuffer;

        if (Buffer.isBuffer(file)) {
            dataBuffer = file; // Already a buffer
        } else if (typeof file === 'string') {
            // file path
            if (!Fs.existsSync(file)) throw new Error("PDF file not found: " + file);
            dataBuffer = Fs.readFileSync(file);
        } else {
            throw new Error("Invalid file input");
        }

        const data = await Pdf(dataBuffer);
        return data.text; // return extracted text
    } catch (err) {
        console.error("PDF parsing error:", err);
        throw err;
    }
}

module.exports.parsePDF = parsePDF;
